1bf672daf214dd95938c003304d4e668
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const upload_1 = require("../../src/schemas/upload");
describe('Upload Schemas', () => {
    describe('presignedUrlSchema', () => {
        it('should validate valid presigned URL request', () => {
            const validData = {
                fileName: 'test-image.jpg',
                mimeType: 'image/jpeg',
                type: 'pet'
            };
            const result = upload_1.presignedUrlSchema.safeParse(validData);
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data).toEqual(validData);
            }
        });
        it('should apply default type value', () => {
            const dataWithoutType = {
                fileName: 'test-image.png',
                mimeType: 'image/png'
            };
            const result = upload_1.presignedUrlSchema.safeParse(dataWithoutType);
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data.type).toBe('pet');
            }
        });
        it('should reject empty fileName', () => {
            const invalidData = {
                fileName: '',
                mimeType: 'image/jpeg',
                type: 'pet'
            };
            const result = upload_1.presignedUrlSchema.safeParse(invalidData);
            expect(result.success).toBe(false);
        });
        it('should reject invalid mimeType', () => {
            const invalidData = {
                fileName: 'test.pdf',
                mimeType: 'application/pdf',
                type: 'pet'
            };
            const result = upload_1.presignedUrlSchema.safeParse(invalidData);
            expect(result.success).toBe(false);
        });
        it('should accept all valid image mimeTypes', () => {
            const validMimeTypes = [
                'image/jpeg',
                'image/jpg',
                'image/png',
                'image/webp',
                'image/gif'
            ];
            validMimeTypes.forEach(mimeType => {
                const data = {
                    fileName: 'test-image',
                    mimeType,
                    type: 'avatar'
                };
                const result = upload_1.presignedUrlSchema.safeParse(data);
                expect(result.success).toBe(true);
            });
        });
        it('should reject invalid type values', () => {
            const invalidData = {
                fileName: 'test.jpg',
                mimeType: 'image/jpeg',
                type: 'invalid'
            };
            const result = upload_1.presignedUrlSchema.safeParse(invalidData);
            expect(result.success).toBe(false);
        });
    });
    describe('searchHistoryQuerySchema', () => {
        it('should validate valid search history query', () => {
            const validData = {
                limit: 20
            };
            const result = upload_1.searchHistoryQuerySchema.safeParse(validData);
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data).toEqual(validData);
            }
        });
        it('should apply default limit value', () => {
            const result = upload_1.searchHistoryQuerySchema.safeParse({});
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data.limit).toBe(10);
            }
        });
        it('should reject limit values below minimum', () => {
            const invalidData = {
                limit: 0
            };
            const result = upload_1.searchHistoryQuerySchema.safeParse(invalidData);
            expect(result.success).toBe(false);
        });
        it('should reject limit values above maximum', () => {
            const invalidData = {
                limit: 100
            };
            const result = upload_1.searchHistoryQuerySchema.safeParse(invalidData);
            expect(result.success).toBe(false);
        });
        it('should reject non-integer limit values', () => {
            const invalidData = {
                limit: 10.5
            };
            const result = upload_1.searchHistoryQuerySchema.safeParse(invalidData);
            expect(result.success).toBe(false);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxVc2VyXFxEZXNrdG9wXFx0cmFlcHJvamVjdFxcdGVzdDJcXHBldC1maW5kZXItYXBwXFxiYWNrZW5kXFx0ZXN0XFxzY2hlbWFzXFx1cGxvYWQudGVzdC50cyIsIm1hcHBpbmdzIjoiOztBQUFBLHFEQUtrQztBQUVsQyxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO0lBQzlCLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7UUFDbEMsRUFBRSxDQUFDLDZDQUE2QyxFQUFFLEdBQUcsRUFBRTtZQUNyRCxNQUFNLFNBQVMsR0FBd0I7Z0JBQ3JDLFFBQVEsRUFBRSxnQkFBZ0I7Z0JBQzFCLFFBQVEsRUFBRSxZQUFZO2dCQUN0QixJQUFJLEVBQUUsS0FBSzthQUNaLENBQUM7WUFFRixNQUFNLE1BQU0sR0FBRywyQkFBa0IsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDdkQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEMsSUFBSSxNQUFNLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBQ25CLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7WUFDekMsTUFBTSxlQUFlLEdBQUc7Z0JBQ3RCLFFBQVEsRUFBRSxnQkFBZ0I7Z0JBQzFCLFFBQVEsRUFBRSxXQUFXO2FBQ3RCLENBQUM7WUFFRixNQUFNLE1BQU0sR0FBRywyQkFBa0IsQ0FBQyxTQUFTLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDN0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEMsSUFBSSxNQUFNLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBQ25CLE1BQU0sQ0FBQyxN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TyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3JDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXFVzZXJcXERlc2t0b3BcXHRyYWVwcm9qZWN0XFx0ZXN0MlxccGV0LWZpbmRlci1hcHBcXGJhY2tlbmRcXHRlc3RcXHNjaGVtYXNcXHVwbG9hZC50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFxuICBwcmVzaWduZWRVcmxTY2hlbWEsXG4gIHNlYXJjaEhpc3RvcnlRdWVyeVNjaGVtYSxcbiAgUHJlc2lnbmVkVXJsUmVxdWVzdCxcbiAgU2VhcmNoSGlzdG9yeVF1ZXJ5UmVxdWVzdFxufSBmcm9tICcuLi8uLi9zcmMvc2NoZW1hcy91cGxvYWQnO1xuXG5kZXNjcmliZSgnVXBsb2FkIFNjaGVtYXMnLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdwcmVzaWduZWRVcmxTY2hlbWEnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB2YWxpZCBwcmVzaWduZWQgVVJMIHJlcXVlc3QnLCAoKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZERhdGE6IFByZXNpZ25lZFVybFJlcXVlc3QgPSB7XG4gICAgICAgIGZpbGVOYW1lOiAndGVzdC1pbWFnZS5qcGcnLFxuICAgICAgICBtaW1lVHlwZTogJ2ltYWdlL2pwZWcnLFxuICAgICAgICB0eXBlOiAncGV0J1xuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gcHJlc2lnbmVkVXJsU2NoZW1hLnNhZmVQYXJzZSh2YWxpZERhdGEpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZGF0YSkudG9FcXVhbCh2YWxpZERhdGEpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhcHBseSBkZWZhdWx0IHR5cGUgdmFsdWUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhV2l0aG91dFR5cGUgPSB7XG4gICAgICAgIGZpbGVOYW1lOiAndGVzdC1pbWFnZS5wbmcnLFxuICAgICAgICBtaW1lVHlwZTogJ2ltYWdlL3BuZydcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IHByZXNpZ25lZFVybFNjaGVtYS5zYWZlUGFyc2UoZGF0YVdpdGhvdXRUeXBlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEudHlwZSkudG9CZSgncGV0Jyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBlbXB0eSBmaWxlTmFtZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWREYXRhID0ge1xuICAgICAgICBmaWxlTmFtZTogJycsXG4gICAgICAgIG1pbWVUeXBlOiAnaW1hZ2UvanBlZycsXG4gICAgICAgIHR5cGU6ICdwZXQnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBwcmVzaWduZWRVcmxTY2hlbWEuc2FmZVBhcnNlKGludmFsaWREYXRhKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBpbnZhbGlkIG1pbWVUeXBlJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZERhdGEgPSB7XG4gICAgICAgIGZpbGVOYW1lOiAndGVzdC5wZGYnLFxuICAgICAgICBtaW1lVHlwZTogJ2FwcGxpY2F0aW9uL3BkZicsXG4gICAgICAgIHR5cGU6ICdwZXQnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBwcmVzaWduZWRVcmxTY2hlbWEuc2FmZVBhcnNlKGludmFsaWREYXRhKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFjY2VwdCBhbGwgdmFsaWQgaW1hZ2UgbWltZVR5cGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRNaW1lVHlwZXMgPSBbXG4gICAgICAgICdpbWFnZS9qcGVnJyxcbiAgICAgICAgJ2ltYWdlL2pwZycsXG4gICAgICAgICdpbWFnZS9wbmcnLFxuICAgICAgICAnaW1hZ2Uvd2VicCcsXG4gICAgICAgICdpbWFnZS9naWYnXG4gICAgICBdO1xuXG4gICAgICB2YWxpZE1pbWVUeXBlcy5mb3JFYWNoKG1pbWVUeXBlID0+IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgICBmaWxlTmFtZTogJ3Rlc3QtaW1hZ2UnLFxuICAgICAgICAgIG1pbWVUeXBlLFxuICAgICAgICAgIHR5cGU6ICdhdmF0YXInIGFzIGNvbnN0XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gcHJlc2lnbmVkVXJsU2NoZW1hLnNhZmVQYXJzZShkYXRhKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBpbnZhbGlkIHR5cGUgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZERhdGEgPSB7XG4gICAgICAgIGZpbGVOYW1lOiAndGVzdC5qcGcnLFxuICAgICAgICBtaW1lVHlwZTogJ2ltYWdlL2pwZWcnLFxuICAgICAgICB0eXBlOiAnaW52YWxpZCdcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IHByZXNpZ25lZFVybFNjaGVtYS5zYWZlUGFyc2UoaW52YWxpZERhdGEpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NlYXJjaEhpc3RvcnlRdWVyeVNjaGVtYScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHZhbGlkIHNlYXJjaCBoaXN0b3J5IHF1ZXJ5JywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWREYXRhOiBTZWFyY2hIaXN0b3J5UXVlcnlSZXF1ZXN0ID0ge1xuICAgICAgICBsaW1pdDogMjBcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNlYXJjaEhpc3RvcnlRdWVyeVNjaGVtYS5zYWZlUGFyc2UodmFsaWREYXRhKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvRXF1YWwodmFsaWREYXRhKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYXBwbHkgZGVmYXVsdCBsaW1pdCB2YWx1ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNlYXJjaEhpc3RvcnlRdWVyeVNjaGVtYS5zYWZlUGFyc2Uoe30pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZGF0YS5saW1pdCkudG9CZSgxMCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBsaW1pdCB2YWx1ZXMgYmVsb3cgbWluaW11bScsICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWREYXRhID0ge1xuICAgICAgICBsaW1pdDogMFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gc2VhcmNoSGlzdG9yeVF1ZXJ5U2NoZW1hLnNhZmVQYXJzZShpbnZhbGlkRGF0YSk7XG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgbGltaXQgdmFsdWVzIGFib3ZlIG1heGltdW0nLCAoKSA9PiB7XG4gICAgICBjb25zdCBpbnZhbGlkRGF0YSA9IHtcbiAgICAgICAgbGltaXQ6IDEwMFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gc2VhcmNoSGlzdG9yeVF1ZXJ5U2NoZW1hLnNhZmVQYXJzZShpbnZhbGlkRGF0YSk7XG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3Qgbm9uLWludGVnZXIgbGltaXQgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZERhdGEgPSB7XG4gICAgICAgIGxpbWl0OiAxMC41XG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBzZWFyY2hIaXN0b3J5UXVlcnlTY2hlbWEuc2FmZVBhcnNlKGludmFsaWREYXRhKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9