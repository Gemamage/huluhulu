{"file":"C:\\Users\\User\\Desktop\\traeproject\\test2\\pet-finder-app\\backend\\src\\config\\environment.ts","mappings":"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","names":[],"sources":["C:\\Users\\User\\Desktop\\traeproject\\test2\\pet-finder-app\\backend\\src\\config\\environment.ts"],"sourcesContent":["import dotenv from 'dotenv';\nimport Joi from 'joi';\n\n// 載入環境變數\ndotenv.config();\n\n// 環境變數驗證 schema\nconst envSchema = Joi.object({\n  NODE_ENV: Joi.string()\n    .valid('development', 'production', 'test')\n    .default('development'),\n  PORT: Joi.number().default(3001),\n  MONGODB_URI: Joi.string().required(),\n  JWT_SECRET: Joi.string().min(32).required(),\n  JWT_EXPIRES_IN: Joi.string().default('7d'),\n  CORS_ORIGIN: Joi.string().default('http://localhost:3000'),\n  CLOUDINARY_CLOUD_NAME: Joi.string().required(),\n  CLOUDINARY_API_KEY: Joi.string().required(),\n  CLOUDINARY_API_SECRET: Joi.string().required(),\n  EMAIL_HOST: Joi.string().default('smtp.gmail.com'),\n  EMAIL_PORT: Joi.number().default(587),\n  EMAIL_USER: Joi.string().email().required(),\n  EMAIL_PASS: Joi.string().required(),\n  EMAIL_FROM_NAME: Joi.string().default('呼嚕寵物協尋網站'),\n  EMAIL_FROM_EMAIL: Joi.string().email().required(),\n  CLIENT_URL: Joi.string().default('http://localhost:3000'),\n  RATE_LIMIT_WINDOW_MS: Joi.number().default(15 * 60 * 1000),\n  RATE_LIMIT_MAX_REQUESTS: Joi.number().default(100),\n  LOG_LEVEL: Joi.string()\n    .valid('error', 'warn', 'info', 'debug')\n    .default('info'),\n  // Google OAuth 配置\n  GOOGLE_CLIENT_ID: Joi.string().required(),\n  GOOGLE_CLIENT_SECRET: Joi.string().required(),\n  GOOGLE_CALLBACK_URL: Joi.string().default('/api/auth/google/callback'),\n  // Session 配置\n  SESSION_SECRET: Joi.string().min(32).required(),\n\n  // Google Vision AI 配置\n  GOOGLE_VISION_PROJECT_ID: Joi.string().optional(),\n  GOOGLE_VISION_KEY_PATH: Joi.string().optional(),\n  \n  // Firebase 配置\n  FIREBASE_PROJECT_ID: Joi.string().optional(),\n  FIREBASE_SERVICE_ACCOUNT_KEY: Joi.string().optional(),\n  \n  // SendGrid 配置\n  SENDGRID_API_KEY: Joi.string().optional(),\n  SENDGRID_FROM_EMAIL: Joi.string().email().optional(),\n  \n  // 通知配置\n  NOTIFICATION_CLEANUP_INTERVAL: Joi.number().default(60 * 60 * 1000), // 1 小時\n  NOTIFICATION_RETENTION_DAYS: Joi.number().default(30),\n}).unknown();\n\n// 驗證環境變數\nconst { error, value: envVars } = envSchema.validate(process.env);\n\nif (error) {\n  throw new Error(`環境變數配置錯誤: ${error.message}`);\n}\n\n// 導出配置物件\nexport const config = {\n  env: envVars.NODE_ENV as 'development' | 'production' | 'test',\n  port: envVars.PORT as number,\n  \n  // 資料庫配置\n  database: {\n    uri: envVars.MONGODB_URI as string,\n    options: {\n      maxPoolSize: 10,\n      serverSelectionTimeoutMS: 5000,\n      socketTimeoutMS: 45000,\n    },\n  },\n  \n  // JWT 配置\n  jwt: {\n    secret: envVars.JWT_SECRET as string,\n    expiresIn: envVars.JWT_EXPIRES_IN as string,\n  },\n  \n  // CORS 配置\n  cors: {\n    allowedOrigins: envVars.CORS_ORIGIN.split(',').map((origin: string) => origin.trim()),\n  },\n  \n  // Cloudinary 配置\n  cloudinary: {\n    cloudName: envVars.CLOUDINARY_CLOUD_NAME as string,\n    apiKey: envVars.CLOUDINARY_API_KEY as string,\n    apiSecret: envVars.CLOUDINARY_API_SECRET as string,\n  },\n  \n  // 郵件配置\n  email: {\n    host: envVars.EMAIL_HOST as string,\n    port: envVars.EMAIL_PORT as number,\n    secure: envVars.EMAIL_PORT === 465,\n    user: envVars.EMAIL_USER as string,\n    password: envVars.EMAIL_PASS as string,\n    fromName: envVars.EMAIL_FROM_NAME as string,\n    fromEmail: envVars.EMAIL_FROM_EMAIL as string,\n  },\n\n  // 客戶端 URL\n  clientUrl: envVars.CLIENT_URL as string,\n  \n  // 速率限制配置\n  rateLimit: {\n    windowMs: envVars.RATE_LIMIT_WINDOW_MS as number,\n    maxRequests: envVars.RATE_LIMIT_MAX_REQUESTS as number,\n  },\n  \n  // 日誌配置\n  logging: {\n    level: envVars.LOG_LEVEL as string,\n  },\n  \n  // 檔案上傳配置\n  upload: {\n    maxFileSize: 5 * 1024 * 1024, // 5MB\n    allowedMimeTypes: [\n      'image/jpeg',\n      'image/png',\n      'image/webp',\n      'image/gif',\n    ],\n    maxFiles: 5,\n  },\n  \n  // 分頁配置\n  pagination: {\n    defaultLimit: 20,\n    maxLimit: 100,\n  },\n  \n  // 快取配置\n  cache: {\n    ttl: 5 * 60, // 5 分鐘\n  },\n  \n  // Google 服務配置\n  google: {\n    clientId: envVars.GOOGLE_CLIENT_ID as string,\n    clientSecret: envVars.GOOGLE_CLIENT_SECRET as string,\n    callbackUrl: envVars.GOOGLE_CALLBACK_URL as string,\n    projectId: envVars.GOOGLE_VISION_PROJECT_ID as string || '',\n    visionKeyPath: envVars.GOOGLE_VISION_KEY_PATH as string || '',\n  },\n  \n  // Session 配置\n  session: {\n    secret: envVars.SESSION_SECRET as string,\n    maxAge: 24 * 60 * 60 * 1000, // 24 小時\n  },\n  \n  // Firebase 配置\n  firebase: {\n    projectId: envVars.FIREBASE_PROJECT_ID as string || '',\n    serviceAccountKey: envVars.FIREBASE_SERVICE_ACCOUNT_KEY \n      ? JSON.parse(envVars.FIREBASE_SERVICE_ACCOUNT_KEY as string) \n      : null,\n  },\n  \n  // SendGrid 配置\n  sendgrid: {\n    apiKey: envVars.SENDGRID_API_KEY as string || '',\n    fromEmail: envVars.SENDGRID_FROM_EMAIL as string || envVars.EMAIL_FROM_EMAIL as string,\n  },\n  \n  // 通知配置\n  notification: {\n    cleanupInterval: envVars.NOTIFICATION_CLEANUP_INTERVAL as number,\n    retentionDays: envVars.NOTIFICATION_RETENTION_DAYS as number,\n    batchSize: 100,\n    maxRetries: 3,\n    retryDelay: 5000, // 5 秒\n  },\n\n} as const;\n\n// 型別定義\nexport type Config = typeof config;\nexport type Environment = typeof config.env;"],"version":3}